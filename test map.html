<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Carte Hex France</title>
<style>
  svg { border: 1px solid #ccc; }
  polygon { transition: fill 0.5s; }
</style>
</head>
<body>

<h2>Carte Hex France</h2>
<svg id="france-map" width="748" height="493">
  <image href="bretagne.png" width="748" height="493"/>
</svg>

<button id="revealButton">Révéler un hex</button>
<div id="timer"></div>

<script>
const svg = document.getElementById("france-map");
const hexSize = 30;
let hexCounter = 0;
const hexes = [];






// Fonction pour générer les points d'un hexagone
function calculateHexPoints(cx, cy, size) {
  let points = [];
  for (let i = 0; i < 6; i++) {
    const angle = 0.65 + i;
    const x = cx + size * Math.cos(angle);
    const y = cy + size * Math.sin(angle+0.1);
    points.push(`${x},${y}`);
  }
  return points.join(" ");
}

// Génération automatique de la grille
function generateHexGrid(svg, width, height, hexSize) {
  const hexHeight = Math.sqrt(3) * hexSize;
  const hexWidth = 2 * hexSize;
  const vertDist = hexHeight * 0.75;
  const horizDist = hexWidth * 0.75;
  
  let idCounter = 0;
  for (let y =19; y < height + hexHeight; y += vertDist) {
    for (let x = 5; x < width + hexWidth; x += horizDist) {
      const offsetX = (Math.floor(y / vertDist) % 2) * (hexSize * 0.75);
      const points = calculateHexPoints(x + offsetX, y, hexSize);
      const hex = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
      hex.setAttribute("points", points);
      hex.setAttribute("fill", "");
      hex.setAttribute("stroke", "white");
      hex.setAttribute("id", "hex_" + idCounter);
      svg.appendChild(hex);
      hexes.push(hex); // stocker pour pouvoir les révéler
      idCounter++;
    }
  }
}

generateHexGrid(svg, 748, 493, hexSize);

// Fonction pour révéler un hexagone
function revealHex() {
  if (hexCounter >= hexes.length) return;
  const hex = hexes[hexCounter++];
  hex.setAttribute("fill", "transparent");
  hex.setAttribute("stroke", "transparent"); // révèle la carte dessous
}


function startTimer(duration) {

  timeLeft = duration;

  timerInterval = setInterval(() => {
    timeLeft--;
    updateTimerDisplay(timeLeft)
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      revealHex();
      
    }
  }, 1000);
}
document.getElementById("revealButton").addEventListener("click", () => {startTimer(10);});

function updateTimerDisplay(seconds) {
  const min = Math.floor(seconds / 60);
  const sec = seconds % 60;
  document.getElementById("timer").textContent =
    `${min}:${sec.toString().padStart(2, "0")}`;
}
</script>
</body>
</html>
